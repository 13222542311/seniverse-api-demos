<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ThinkPage API Jsonp Test Page</title>
  <script type="text/javascript" src="scripts/jquery.js"></script>
  <script type="text/javascript" src="scripts/hmac-sha1.js"></script>
</head>
<body>
  <div id="content">
  </div>
<script>
  // 此处是获取天气 (测试用key，请更换成您自己的Key)
  var UID = "U785B76FC9";
  var KEY = "4r9bergjetiv1tsd";
  var API = "http://api.thinkpage.cn/v3/weather/now.json?location=beijing&";

  var ts = Math.floor((new Date()).getTime() / 1000);
  var str = "ts="+ts+"&uid=" + UID;

  var sig = CryptoJS.HmacSHA1(str, KEY).toString(CryptoJS.enc.Base64);
  sig = encodeURIComponent(sig);
  str = str + "&sig=" + sig;

  var url = API + str + "&callback=?";

  $.getJSON(url, function(data) {
    var obj = document.getElementById('content');
    var weather = data.results[0]

    var text = [];
    text.push("Location: " + weather.location.path);
    text.push("Weather: " + weather.now.text);
    text.push("Temperature: " + weather.now.temperature);

    obj.innerText = text.join("\n")
  });
</script>
</body>
</html>
